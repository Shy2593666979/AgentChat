# ğŸŒ Node.js 18+ åŸºç¡€é•œåƒ
FROM node:18-alpine as frontend-base

# ğŸ”§ è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# ğŸ“¦ è®¾ç½®npmé•œåƒæºï¼ˆåŠ é€Ÿä¸‹è½½ï¼‰
RUN npm config set registry https://registry.npmmirror.com

# ğŸ“¦ å®‰è£…curlå·¥å…·
RUN apk add --no-cache curl

# ğŸ“‹ å¤åˆ¶packageæ–‡ä»¶
COPY src/frontend/package*.json ./

# ğŸš€ å®‰è£…ä¾èµ–
RUN npm install

# ğŸ“ å¤åˆ¶å‰ç«¯ä»£ç 
COPY src/frontend/ .

# ğŸŒ è®¾ç½®ç¯å¢ƒå˜é‡
ENV NODE_ENV=development
ENV VITE_API_BASE_URL=http://localhost:7860

# ğŸš€ æš´éœ²ç«¯å£
EXPOSE 8090

# ğŸƒâ€â™‚ï¸ å¯åŠ¨å¼€å‘æœåŠ¡å™¨
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0", "--port", "8090"]